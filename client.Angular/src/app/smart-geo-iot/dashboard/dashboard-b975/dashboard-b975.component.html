<div class="body-content">
  <section class="body-wrapper">

    <div class="headline" fxLayout>
      <button mat-icon-button routerLink="/">
        <mat-icon>arrow_back</mat-icon>
      </button>
      <div class="mat-h1">Dashboard</div>

      <div class="buttonBoxArea right">
        <button mat-button color="primary" class="filterBoxAreaButton" title="filter"
          (click)="showFilters = !showFilters;">
          <mat-icon>tune</mat-icon>
          <span>filter</span>
        </button>
      </div>
    </div>

    <form *ngIf="showFilters" [formGroup]="form" class="container filterBoxArea" fxLayout fxLayoutGap="10px"
      fxLayout.xs="column">
      <mat-form-field appearance="outline" fxFlex="1 1">
        <mat-label>Pesquisar</mat-label>
        <input matInput placeholder="Pesquisar por nome ou categoria" #searchBox id="search-box"
          (keyup)="filterIfNotMobile(searchBox.value)" (keyup.enter)="filter(searchBox.value)">
        <mat-icon matSuffix>search</mat-icon>
      </mat-form-field>
    </form>

    <div *ngIf="results.length > 0" class="container">

      <mat-table [dataSource]="results" class="mat-elevation-z4 with-hover" style="margin-bottom: 20px">

        <ng-container matColumnDef="nickName">
          <mat-header-cell *matHeaderCellDef fxFlex="15%" fxFlex.lt-sm="15%">Veículo</mat-header-cell>
          <mat-cell *matCellDef="let element" fxFlex="15%" fxFlex.lt-sm="15%">{{element.nickName}}</mat-cell>
        </ng-container>

        <ng-container matColumnDef="name">
          <mat-header-cell *matHeaderCellDef fxFlex="10%" fxFlex.lt-sm="10%">DJRF</mat-header-cell>
          <mat-cell *matCellDef="let element" fxFlex="10%" fxFlex.lt-sm="10%">{{element.name}}</mat-cell>
        </ng-container>

        <ng-container matColumnDef="statusDJ">
          <mat-header-cell *matHeaderCellDef fxFlex="15%" fxFlex.lt-sm="15%" fxLayoutAlign="center center">
            <span style="text-align: center;">
              Evento
              <br>
              <span>{{filtrarBloqueios ? '(Somente bloqueios)' : '(Todos)'}}</span>
            </span>
            <span class="material-icons" (click)="filterStatusBloqueio()">unfold_more</span>
          </mat-header-cell>
          <mat-cell *matCellDef="let element" fxFlex="15%" fxFlex.lt-sm="15%" fxLayoutAlign="center center">
            <span class="span-status {{element.statusDJ ? bgStatusDJ(element.statusDJ) : ''}}">{{textSatusDJ(element.statusDJ)}}</span>
          </mat-cell>
        </ng-container>

        <!-- <ng-container matColumnDef="contadorCarencias">
          <mat-header-cell *matHeaderCellDef fxFlex="10%" fxFlex.lt-sm="10%">Carências</mat-header-cell>
          <mat-cell *matCellDef="let element" fxFlex="10%" fxFlex.lt-sm="10%">{{element.contadorCarencias}}</mat-cell>
        </ng-container>

        <ng-container matColumnDef="contadorBloqueios">
          <mat-header-cell *matHeaderCellDef fxFlex="10%" fxFlex.lt-sm="10%">Bloqueios</mat-header-cell>
          <mat-cell *matCellDef="let element" fxFlex="10%" fxFlex.lt-sm="10%">{{element.contadorBloqueios}}</mat-cell>
        </ng-container> -->

        <ng-container matColumnDef="locationCity">
          <mat-header-cell *matHeaderCellDef fxFlex="60%" fxFlex.lt-sm="60%">Localização</mat-header-cell>
          <mat-cell *matCellDef="let element" fxFlex="60%" fxFlex.lt-sm="60%">{{element.locationCity}}</mat-cell>
        </ng-container>

        <ng-container matColumnDef="date">
          <mat-header-cell *matHeaderCellDef fxFlex="12%" fxFlex.lt-sm="12%">Último</mat-header-cell>
          <mat-cell *matCellDef="let element" fxFlex="12%" fxFlex.lt-sm="12%">
            <span class="span-status {{element.date ? getClassDiffTime(element.date) : ''}}">{{element.date | date: 'dd/MM/yyyy HH:mm:ss'}}</span>
          </mat-cell>
        </ng-container>




        <ng-container matColumnDef="chamado">
          <mat-header-cell *matHeaderCellDef fxFlex="55%" fxFlex.lt-sm="55%" fxLayoutAlign="center center">Chamado</mat-header-cell>
          <mat-cell *matCellDef="let element" fxFlex="55%" fxFlex.lt-sm="55%" fxLayoutAlign="center center">
            <button mat-button class="bg-carencia" title="Tratar Chamado" *ngIf="isJammer(element.statusDJ)"
              (click)="serviceDeskConfirmDialog(element.deviceId, $event)">
              Tratar
            </button>
            <button mat-button class="bg-operacional btn-chamado-space" title="Finalizar Chamado"
              *ngIf="element.hasServiceDeskOpened" (click)="serviceDeskConfirmCloseDialog(element.deviceId, $event)">
              Finalizar
            </button>

            <span class="material-icons info" *ngIf="element.hasHistoryServiceDesk" title="Histórico de chamados"
              (click)="openHistoryBottomSheet(element.deviceId, $event)">info
            </span>

          </mat-cell>
        </ng-container>






        <mat-header-row *matHeaderRowDef="displayedColumns"></mat-header-row>
        <mat-row *matRowDef="let row; columns: displayedColumns;" routerLink="{{row.deviceId}}"></mat-row>

      </mat-table>

    </div>

    <h2 *ngIf="results.length==0 && !firstSearch">Nenhum projeto encontrado. Tente alterar sua pesquisa.</h2>

    <!-- <app-pagination [skip]="skip" [pageSize]="pageSize" [totalCount]="totalCount" (pageChanged)="pageChanged($event)">
    </app-pagination> -->

  </section>
</div>